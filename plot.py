import numpy as np
import random as rd
import pandas as pd
import mne
import os

import palettable
import matplotlib.pyplot as plt
import seaborn as sns

label_text = {0: "AD Group", 1: "CN Group", 2: "FTD Group"}


def get_path(no: int) -> str:
    path = "sub-"
    if no < 10:
        path += "00"
    elif no < 100:
        path += "0"
    path += str(no)
    return path


def get_raw(no: int) -> mne.io.Raw:
    sub_path = get_path(no=no)
    data_prefix = os.path.join(
        "..",
        "dataset",
        "derivatives",
        sub_path,
        "eeg",
        sub_path + "_task-eyesclosed_eeg.set",
    )
    return mne.io.read_raw_eeglab(
        data_prefix,
        "auto",
        True,
        "utf-8",
    )


def plot_montage():
    # montage_list = mne.channels.get_builtin_montages()
    # standard_montage = mne.channels.make_standard_montage("biosemi32")
    # standard_montage.plot()
    raw = get_raw(20)
    mne.viz.plot_montage(raw.get_montage(), sphere=0.12, scale_factor=30)


def plot_eeg_wave():
    raw_a = get_raw(17)
    raw_c = get_raw(52)
    raw_f = get_raw(67)

    raw_a.plot(duration=10, scalings="auto", show_options=True, block=True)
    raw_c.plot(duration=10, scalings="auto", show_options=True, block=True)
    raw_f.plot(duration=10, scalings="auto", show_options=True, block=True)


def plot_eeg_spectrum():
    raw_a = get_raw(17)
    raw_c = get_raw(52)
    raw_f = get_raw(67)

    bands = {
        "Delta (0-4 Hz)": (0, 4),
        "Theta (4-8 Hz)": (4, 8),
        "Alpha (8-16 Hz)": (8, 16),
        "Beta (16-32 Hz)": (16, 32),
    }
    raw_a.compute_psd().plot_topomap(bands=bands, outlines="head", sphere=0.12)
    raw_a.compute_psd().plot_topo(block=True)
    raw_c.compute_psd().plot_topomap(bands=bands, outlines="head", sphere=0.12)
    raw_f.compute_psd().plot_topomap(bands=bands, outlines="head", sphere=0.12)


def plot_feature_dist() -> None:
    fre_names = ["theta", "delta", "alpha", "beta"]
    dataset = None
    for cur_fre in fre_names:
        cur_dataset_path = os.path.join(
            "..", "output", "dataset", "all-" + cur_fre + ".csv"
        )
        cur_dataset = pd.read_csv(cur_dataset_path).drop(
            columns=["Unnamed: 0"], inplace=False
        )
        cur_dataset["frequency"] = cur_fre
        # rename_dict = {}
        # for column in cur_dataset.columns:
        #     rename_dict[column] = cur_fre + "_" + column
        # cur_dataset.rename(columns=rename_dict, inplace=True)
        if dataset is None:
            dataset = cur_dataset
        else:
            dataset = pd.concat([dataset, cur_dataset], axis=0)
    # dataset.drop(columns=["theta_class", "delta_class", "alpha_class"], inplace=True)
    # dataset.rename(columns={"beta_class": "class"}, inplace=True)
    dataset.replace({"class": label_text}, inplace=True)

    # plt.figure(figsize=(4, 1), dpi=660)
    # fig, axs = plt.subplots(1, 4, figsize=(8, 2))
    sns.set_context(context="paper")
    g = sns.catplot(
        data=dataset,
        x="class",
        y="ddi_0",
        kind="violin",
        orient="v",
        col="frequency",
        sharey=True,
        palette=sns.color_palette("tab10"),
        order=["AD Group", "FTD Group", "CN Group"],
        height=2.7,
        aspect=1,
    )
    g.set_xlabels("")
    g.set_titles(col_template="{col_name}")
    # import matplotlib.axes
    # matplotlib.axes.Axes.

    plt.show()


def plot_anova():
    sns.set_context(context="paper")

    delta_pval = [
        7.070743995193798e-05,
        8.082853213277909e-05,
        0.000124844073411068,
        0.00027373793993785956,
        0.0008838340035438161,
        0.0010519990532590069,
        0.001678264717754817,
        0.0019042718683427089,
        0.0020491813511632,
        0.0043269062939723935,
        0.004634164895620305,
        0.005658536991532783,
        0.006562619083990115,
        0.007632883567678898,
        0.007672801307991845,
        0.007979034540338508,
        0.008557240948199934,
        0.011537042748974213,
        0.011608144263720985,
        0.01602134390674089,
        0.016292097814213095,
        0.020423042081928713,
        0.021355741698468853,
        0.022070315362183953,
        0.02212830213485527,
        0.024069836931898157,
        0.024369429222346608,
        0.026066860880601995,
        0.026735356224766152,
        0.026827626555338085,
        0.03075158772305217,
        0.03483056970028457,
        0.037565768151949556,
        0.040102873858211964,
        0.04038768660230006,
        0.0407071011352026,
        0.04282767339232176,
        0.0434033497273574,
        0.04839843550890989,
        0.04964914530245436,
        0.05195409927823289,
        0.05370073029787479,
        0.05439798038700096,
        0.05879370682600678,
        0.0655576884645419,
        0.0671475166970086,
        0.06978701512580261,
        0.07647057750433015,
        0.0777995084053362,
        0.08786401158830444,
        0.08793668732084461,
        0.09422451354592118,
        0.10605608008753467,
        0.11168284400388355,
        0.11786685505380735,
        0.12075543934854974,
        0.12803788260915244,
        0.13404956567291543,
        0.13593364384971382,
        0.14614763917639892,
        0.1503507657913633,
        0.1574014485637421,
        0.16232737670812952,
        0.17211134438385525,
        0.17986826095995578,
        0.18190663289831777,
        0.21119672113569263,
        0.21428793829242854,
        0.22911653618245584,
        0.23696163010242133,
        0.2685537914309378,
        0.33406727154024823,
        0.3721410279633215,
        0.37232682882826373,
        0.4029143564439459,
        0.4239341687089606,
        0.5478882430997101,
        0.6742690992662523,
    ]
    delta_name = [
        "awe_pli_17",
        "awd_10",
        "awe_pli_15",
        "awe_pli_2",
        "awd_0",
        "awe_pli_11",
        "awd_11",
        "awd_3",
        "entropy_0",
        "entropy_10",
        "entropy_3",
        "awd_2",
        "ddi_15",
        "awe_pli_4",
        "awd_16",
        "awd_1",
        "awe_pli_18",
        "awe_pli_3",
        "awe_pli_16",
        "ddi_0",
        "awd_12",
        "entropy_12",
        "entropy_16",
        "ddi_10",
        "entropy_11",
        "entropy_9",
        "entropy_2",
        "awd_8",
        "ddi_9",
        "awd_6",
        "awe_pli_14",
        "ddi_16",
        "awe_pli_13",
        "entropy_4",
        "awe_pli_5",
        "entropy_14",
        "entropy_15",
        "ddi_8",
        "ddi_3",
        "awd_15",
        "ddi_12",
        "ddi_7",
        "awe_pli_8",
        "entropy_8",
        "awd_13",
        "ddi_2",
        "entropy_1",
        "awe_pli_12",
        "awd_14",
        "awe_pli_7",
        "ddi_18",
        "awe_pli_9",
        "ddi_11",
        "awd_9",
        "awd_4",
        "awe_pli_0",
        "mcc",
        "awd_7",
        "ddi_4",
        "awd_18",
        "ddi_1",
        "awe_pli_1",
        "ddi_14",
        "awe_pli_10",
        "awd_17",
        "entropy_7",
        "ddi_5",
        "entropy_6",
        "ddi_6",
        "ddi_13",
        "entropy_18",
        "mpc",
        "entropy_17",
        "entropy_13",
        "ddi_17",
        "awe_pli_6",
        "awd_5",
        "entropy_5",
    ]
    delta_pdf = pd.DataFrame([])
    delta_pdf["name"] = delta_name
    delta_pdf["pval"] = delta_pval
    delta_pdf["-pval_log10"] = -np.log10(delta_pdf["pval"])
    delta_pdf["category"] = [_[:3] for _ in delta_name]

    theta_pval = [
        5.695198519336716e-24,
        1.061289294017188e-16,
        1.489223663834102e-14,
        1.6335620666619183e-14,
        2.393895375508049e-13,
        9.111288977069252e-13,
        3.085422552215421e-12,
        1.5519940387696522e-11,
        4.7027945261639736e-11,
        6.735202391439294e-08,
        5.808311303189837e-07,
        2.9975805566825902e-05,
        5.472031700172539e-05,
        0.00018543221611485488,
        0.0006244154160542404,
        0.0014713693331484055,
        0.0018115022796383225,
        0.0024923898699704865,
        0.005578286289007235,
        0.005828070179341416,
        0.00616319018458246,
        0.008131702402492827,
        0.009478767769096983,
        0.014758571012344504,
        0.017449355144714157,
        0.018830866674298487,
        0.02225570338711206,
        0.024605214450917335,
        0.025572445317838786,
        0.03808928667440803,
        0.04105011519955039,
        0.041974499151592494,
        0.0732739666919541,
        0.07470557221215213,
        0.08915083653860424,
        0.09077415444499926,
        0.12668395389203277,
        0.1311627498997442,
        0.13670864600614113,
        0.17586834410208518,
        0.17858038755416294,
        0.18215580039648874,
        0.19788485542294543,
        0.2008044739347121,
        0.21341803917176938,
        0.2723646049577624,
        0.30028023238874674,
        0.30106975701048555,
        0.3172368005378535,
        0.36430561578824106,
        0.40793394380587744,
        0.408009829678709,
        0.41584534504131854,
        0.434888678786867,
        0.44309533469414397,
        0.451426097759701,
        0.4571606267977105,
        0.46877527460568513,
        0.5002533101844264,
        0.506785734771499,
        0.5259035261534827,
        0.5478489535578657,
        0.5560398064764249,
        0.5759731689608412,
        0.5944263851880974,
        0.6315645168637516,
        0.7130253045417437,
        0.8031315097524542,
        0.8054615103550584,
        0.826511110975008,
        0.8340973707967918,
        0.8539469755223665,
        0.8669643731818069,
        0.8996499643038148,
        0.9387591794724038,
        0.9521197332640385,
        0.9532845440683649,
        0.9717361582158548,
    ]
    theta_name = [
        "ddi_9",
        "ddi_8",
        "ddi_14",
        "mcc",
        "awd_9",
        "awd_8",
        "awd_14",
        "ddi_15",
        "awd_15",
        "ddi_6",
        "ddi_18",
        "awd_6",
        "awd_18",
        "ddi_3",
        "awd_3",
        "awd_11",
        "ddi_16",
        "awd_2",
        "ddi_2",
        "ddi_1",
        "ddi_11",
        "awd_0",
        "awe_pli_5",
        "awd_10",
        "awd_16",
        "awe_pli_4",
        "ddi_7",
        "awd_1",
        "ddi_0",
        "awd_13",
        "awd_12",
        "awd_7",
        "ddi_13",
        "ddi_17",
        "entropy_10",
        "entropy_13",
        "awe_pli_17",
        "awe_pli_14",
        "entropy_5",
        "awe_pli_6",
        "entropy_8",
        "entropy_7",
        "awe_pli_3",
        "awd_5",
        "entropy_18",
        "entropy_17",
        "ddi_12",
        "awe_pli_7",
        "entropy_0",
        "ddi_5",
        "entropy_15",
        "awe_pli_12",
        "entropy_12",
        "ddi_4",
        "awe_pli_11",
        "entropy_14",
        "entropy_3",
        "mpc",
        "entropy_9",
        "entropy_6",
        "entropy_4",
        "entropy_11",
        "awe_pli_8",
        "ddi_10",
        "awe_pli_2",
        "awe_pli_18",
        "awe_pli_16",
        "awe_pli_0",
        "awe_pli_15",
        "entropy_1",
        "awe_pli_13",
        "awd_17",
        "entropy_2",
        "awe_pli_1",
        "awd_4",
        "awe_pli_9",
        "entropy_16",
        "awe_pli_10",
    ]
    theta_pdf = pd.DataFrame([])
    theta_pdf["name"] = theta_name
    theta_pdf["pval"] = theta_pval
    theta_pdf["-pval_log10"] = -np.log10(theta_pdf["pval"])
    theta_pdf["category"] = [_[:3] for _ in theta_name]

    alpha_pval = [
        3.856863404022483e-42,
        1.425721811972111e-28,
        7.709821414814301e-26,
        1.03668503898532e-24,
        4.226465350493285e-24,
        1.1265382382502647e-23,
        2.6407177729752056e-23,
        7.281284305186307e-21,
        1.3541357021968098e-20,
        1.9729000276889578e-20,
        3.936113200886438e-20,
        4.875655863966759e-20,
        3.090582454799953e-19,
        2.2757321692907165e-18,
        9.847961706158285e-18,
        1.867854583033985e-17,
        2.0507435152716078e-17,
        1.8867362135247718e-16,
        8.804777678533474e-16,
        2.6567712193520775e-14,
        3.55811627894502e-14,
        1.729381175958331e-12,
        5.127223876549955e-12,
        6.8012300166601244e-12,
        1.6465379268664608e-10,
        2.7594376816420877e-09,
        3.5062878476548946e-09,
        2.9608507649646804e-08,
        9.414417499589666e-07,
        2.9118523642404002e-06,
        3.388950373994566e-06,
        3.5573944636481314e-06,
        8.139293252490465e-06,
        1.302148943731154e-05,
        2.6447223147553196e-05,
        3.743184538144604e-05,
        6.331637139744328e-05,
        8.129502180219765e-05,
        0.00011454332490438229,
        0.00022771336171423064,
        0.00026047354936093635,
        0.0004390522867917231,
        0.0004733740185170984,
        0.0007222971409849415,
        0.0012654811802260701,
        0.0012806525252740527,
        0.001805813720687095,
        0.0020606275635514848,
        0.002779293568703807,
        0.0041143003710723295,
        0.006096570956620499,
        0.007004525161574574,
        0.007288964564179674,
        0.0075016560558858626,
        0.008727699665212831,
        0.00969020711822685,
        0.012736506855893575,
        0.01977260810795485,
        0.025883816710405034,
        0.031207289164228408,
        0.03865779431694364,
        0.040672814039893576,
        0.04397227434724582,
        0.07647920772147644,
        0.07794661638135711,
        0.08507062241820885,
        0.09023858209225102,
        0.14409745529576817,
        0.17918191782706308,
        0.18970762818947223,
        0.217255561313048,
        0.38993572429897083,
        0.493448218023945,
        0.6596226607071285,
        0.6741748109734378,
        0.7121604089707273,
        0.9405235690749928,
        0.9441227275744253,
    ]
    alpha_name = [
        "mcc",
        "entropy_14",
        "awe_pli_18",
        "awe_pli_9",
        "entropy_8",
        "awe_pli_8",
        "entropy_9",
        "awe_pli_0",
        "awe_pli_14",
        "awe_pli_13",
        "awe_pli_6",
        "awe_pli_11",
        "awe_pli_1",
        "awe_pli_15",
        "awe_pli_12",
        "awe_pli_3",
        "awe_pli_10",
        "awe_pli_2",
        "entropy_6",
        "awe_pli_7",
        "ddi_0",
        "awe_pli_16",
        "ddi_12",
        "entropy_18",
        "awd_0",
        "entropy_15",
        "entropy_1",
        "entropy_3",
        "entropy_11",
        "ddi_1",
        "entropy_7",
        "ddi_2",
        "ddi_10",
        "awe_pli_17",
        "awd_12",
        "awd_1",
        "ddi_3",
        "ddi_6",
        "awe_pli_4",
        "awd_10",
        "entropy_0",
        "ddi_16",
        "entropy_2",
        "awd_16",
        "awd_2",
        "entropy_13",
        "entropy_16",
        "awd_14",
        "ddi_11",
        "entropy_12",
        "ddi_8",
        "ddi_4",
        "awd_8",
        "ddi_18",
        "awd_3",
        "ddi_7",
        "ddi_14",
        "entropy_10",
        "awe_pli_5",
        "awd_6",
        "entropy_4",
        "awd_15",
        "ddi_13",
        "awd_9",
        "awd_4",
        "awd_11",
        "awd_17",
        "awd_18",
        "ddi_15",
        "ddi_5",
        "ddi_9",
        "entropy_5",
        "ddi_17",
        "awd_13",
        "mpc",
        "awd_7",
        "entropy_17",
        "awd_5",
    ]
    alpha_pdf = pd.DataFrame([])
    alpha_pdf["name"] = alpha_name
    alpha_pdf["pval"] = alpha_pval
    alpha_pdf["-pval_log10"] = -np.log10(alpha_pdf["pval"])
    alpha_pdf["category"] = [_[:3] for _ in alpha_name]

    beta_pval = [
        6.49633797152534e-35,
        2.1553192167128374e-33,
        8.01294579773357e-28,
        2.9297504024660178e-25,
        4.652899856234002e-25,
        1.0124165913968702e-23,
        2.823290823247011e-22,
        2.9261023457011014e-21,
        3.897171647741699e-17,
        5.6774128800625255e-15,
        1.386423374400234e-12,
        9.272351599529048e-12,
        1.043776991468325e-11,
        2.322965567802515e-11,
        5.683331264294847e-11,
        5.277103279092283e-10,
        4.402594104273081e-09,
        5.277717685525935e-09,
        6.514382437554597e-09,
        7.512612111684875e-09,
        5.371069480846786e-08,
        8.880374733136705e-07,
        1.1762476261207982e-06,
        1.5911286969475152e-06,
        8.860647329575065e-06,
        1.1811610533922815e-05,
        1.6100087610323495e-05,
        2.353018358749612e-05,
        2.7422955650594624e-05,
        3.1370976786892615e-05,
        4.987106535503594e-05,
        0.00010395968801298491,
        0.00017275707458635218,
        0.00020060391607769896,
        0.0004264338351770716,
        0.0005083685333798221,
        0.0005728596964930551,
        0.0007984724205242887,
        0.0011456078302940404,
        0.0019213611617542323,
        0.002152534184039859,
        0.002268390050687754,
        0.0023447778239384176,
        0.0023657781797306755,
        0.002950587762423056,
        0.004746932081057995,
        0.005079606916336206,
        0.006607079819661645,
        0.008630292689012772,
        0.008791772734049014,
        0.01393629636204723,
        0.014740762972111436,
        0.032240023115588774,
        0.03685170025518952,
        0.04072235975784521,
        0.04947351929967024,
        0.04955482822459784,
        0.05459130550784989,
        0.07132064392673775,
        0.07214556405536063,
        0.07828525073458621,
        0.10077997163205657,
        0.10933481637363035,
        0.21595516293174846,
        0.22309455550179788,
        0.23366460057463273,
        0.3052063695243037,
        0.3654923612056632,
        0.3775848482857669,
        0.3913113686895572,
        0.4677191638850797,
        0.5286141554791475,
        0.5567375194245006,
        0.5641275809505966,
        0.5880422125776517,
        0.7882464261416855,
        0.83165773823991,
        0.9466131936062053,
    ]
    beta_name = [
        "ddi_11",
        "ddi_12",
        "ddi_13",
        "ddi_0",
        "mcc",
        "ddi_14",
        "ddi_2",
        "ddi_10",
        "ddi_1",
        "ddi_15",
        "awd_12",
        "awd_14",
        "ddi_3",
        "ddi_18",
        "ddi_6",
        "awd_2",
        "ddi_4",
        "awd_13",
        "awd_6",
        "awd_0",
        "ddi_7",
        "awd_11",
        "ddi_5",
        "ddi_8",
        "awd_15",
        "awd_1",
        "awe_pli_6",
        "entropy_12",
        "awe_pli_8",
        "awd_4",
        "awe_pli_14",
        "awe_pli_11",
        "awe_pli_1",
        "awd_10",
        "awd_8",
        "entropy_7",
        "ddi_9",
        "awe_pli_10",
        "awd_7",
        "awe_pli_5",
        "awe_pli_2",
        "awd_18",
        "awd_3",
        "awe_pli_16",
        "awe_pli_13",
        "awd_9",
        "entropy_16",
        "entropy_18",
        "awe_pli_7",
        "awe_pli_15",
        "awe_pli_18",
        "awd_5",
        "entropy_0",
        "ddi_16",
        "entropy_5",
        "awd_16",
        "awe_pli_3",
        "awe_pli_9",
        "entropy_2",
        "entropy_17",
        "awe_pli_0",
        "awe_pli_4",
        "entropy_9",
        "mpc",
        "entropy_3",
        "awe_pli_17",
        "entropy_15",
        "entropy_14",
        "entropy_8",
        "ddi_17",
        "entropy_13",
        "entropy_11",
        "awd_17",
        "entropy_6",
        "entropy_1",
        "entropy_4",
        "entropy_10",
        "awe_pli_12",
    ]
    beta_pdf = pd.DataFrame([])
    beta_pdf["name"] = beta_name
    beta_pdf["pval"] = beta_pval
    beta_pdf["-pval_log10"] = -np.log10(beta_pdf["pval"])
    beta_pdf["category"] = [_[:3] for _ in beta_name]

    all_importance = [
        0.015356924768180463,
        0.01376386885931279,
        0.011491430444600978,
        0.010070702550402549,
        0.008641336003338948,
        0.007921777285986234,
        0.007290273345483773,
        0.007085764364701568,
        0.0070098601698825825,
        0.0068171655424781475,
        0.006807280897221747,
        0.006745236585211998,
        0.006566186796024501,
        0.006477609927453197,
        0.006007380328145117,
        0.005810460252211994,
        0.005519222191531665,
        0.0053037262112878205,
        0.0052812091521529155,
        0.005190873179313109,
        0.005096729195473321,
        0.005094673558684653,
        0.00501817332791594,
        0.004995172551191932,
        0.0049576351865064615,
        0.004938693617960603,
        0.004816032349844559,
        0.004779164038158933,
        0.004776126199733274,
        0.0047455668438366305,
        0.004518023000086424,
        0.004512393828550163,
        0.004472086675055921,
        0.004449818101076777,
        0.004351391799759619,
        0.004276033781731119,
        0.004246017506098682,
        0.004171613394128456,
        0.004108273193377787,
        0.004096446675008298,
        0.0040616835852109925,
        0.004038597539151263,
        0.004016214769217179,
        0.003944795816081961,
        0.003939924073169483,
        0.003939016020245934,
        0.003914187055619605,
        0.0038210272073398773,
        0.003816593863869267,
        0.0037717774122879907,
        0.003747822713329072,
        0.0037199460095672155,
        0.0037088455570530444,
        0.0036999110951777096,
        0.0036976324077957457,
        0.003644055928256824,
        0.003639383747509879,
        0.0036164306164064397,
        0.003608272836854537,
        0.003606567559165786,
        0.0035930667020991802,
        0.0035753393544170255,
        0.003545972096739552,
        0.003542359463560494,
        0.003524164283712942,
        0.0034938265629508654,
        0.003482303040103377,
        0.0034774617102320826,
        0.0034453452738624495,
        0.0034363378489074563,
        0.0034284251398093617,
        0.0034165971561924318,
        0.0034140472426249804,
        0.0033726206995452995,
        0.0033722622140542635,
        0.003366458447640308,
        0.003358749750581776,
        0.00335798560157156,
        0.003333372200392721,
        0.003317653090623705,
        0.003310364373231022,
        0.00329534384213024,
        0.003281091668001443,
        0.0032592104523418187,
        0.003250735517265106,
        0.0032493246626152444,
        0.003231826827815784,
        0.0032305569762500035,
        0.0032180699117835255,
        0.0031912747879666,
        0.003179980822872331,
        0.00317047345744522,
        0.003170295554061738,
        0.003169256557666843,
        0.003168167057070184,
        0.003166585963568697,
        0.0031630267971451543,
        0.003152738722192028,
        0.0031324735788002362,
        0.0031314863420328154,
        0.0031123318837165226,
        0.0030995741539641287,
        0.0030913849988702313,
        0.00309019320424765,
        0.0030867126133909428,
        0.0030782197386202575,
        0.003067436292392345,
        0.003064115735761228,
        0.0030613372370480946,
        0.003058988598248663,
        0.0030578285934523314,
        0.0030563283710049547,
        0.0030399434762648546,
        0.003037766280909675,
        0.0030376967026773775,
        0.003037091451479382,
        0.0030337988231302626,
        0.003021681081308333,
        0.0030199837005160184,
        0.003014817888755418,
        0.0030128142979218312,
        0.0030114238759739987,
        0.003010386100218315,
        0.002998370956816809,
        0.002996269401967548,
        0.002992735024180608,
        0.00298835718989563,
        0.0029875996319510224,
        0.0029870935015456094,
        0.0029777949046026707,
        0.0029739482626888864,
        0.0029736097426518782,
        0.002967374279366774,
        0.002965050739358085,
        0.0029568710327465097,
        0.002953931405056083,
        0.002948583361462723,
        0.002944895912461972,
        0.0029420541133853085,
        0.002941342269586202,
        0.0029214622221653214,
        0.00292068144120473,
        0.0029180713677405294,
        0.002912320761480951,
        0.0029043175953343625,
        0.0029015231647384417,
        0.00289893990652601,
        0.002891929528157113,
        0.002881673159400851,
        0.002874591683416861,
        0.0028726726716248397,
        0.0028669933761986495,
        0.00286271392695639,
        0.0028603490281664894,
        0.002852457051436326,
        0.0028518943959910037,
        0.00284529124696186,
        0.002844979719150836,
        0.0028346968478823197,
        0.0028329801909473696,
        0.002829323853676221,
        0.002822968762600571,
        0.002815456678635877,
        0.002815163528535716,
        0.0028147661470011133,
        0.002809094228638448,
        0.002802759870163587,
        0.0028000962951195947,
        0.002795464899142466,
        0.002792689269909141,
        0.0027888375178067833,
        0.002787281495249613,
        0.0027786258097200187,
        0.002777264881988688,
        0.002775520591674469,
        0.002773635104922793,
        0.002768291975630277,
        0.0027531291444434806,
        0.0027507122511197905,
        0.002750566760319191,
        0.002746294080096528,
        0.002745878774087845,
        0.002724000128030362,
        0.0027084171324427276,
        0.0027067191051353846,
        0.002704958318778889,
        0.002702421755133787,
        0.002700252728686697,
        0.0026945368722009937,
        0.002685482700448967,
        0.002682748819276822,
        0.002680181322853644,
        0.002678288453051411,
        0.0026776555913022707,
        0.0026706441556127508,
        0.0026656746827675853,
        0.0026652502660854177,
        0.0026524820239669333,
        0.002646511913781672,
        0.0026386797604350315,
        0.0026370010685038063,
        0.0026356550003154905,
        0.00262798484414254,
        0.002624909295226968,
        0.0026087821329422484,
        0.002607013537887145,
        0.0026066959557183183,
        0.002605642340303369,
        0.002605258609941933,
        0.002596962070702133,
        0.002585298419566263,
        0.0025850648495219105,
        0.002583454719208731,
        0.0025788966576991757,
        0.0025667165536212293,
        0.002566004569476415,
        0.002560364577848523,
        0.0025567587436709956,
        0.002544899057847127,
        0.002530191427415252,
        0.0025259570955242254,
        0.0025175389893960774,
        0.0025143272455500493,
        0.0025137517599117835,
        0.0024999998357466352,
        0.0024947214847583854,
        0.0024931721962457858,
        0.0024889527988685234,
        0.0024861799023429615,
        0.0024797550457687713,
        0.002477980638387826,
        0.002474762535107214,
        0.002462320774718715,
        0.0024597979011417776,
        0.0024596305605455396,
        0.0024524848955348147,
        0.002452004269406788,
        0.0024504775898003,
        0.002444141173127198,
        0.002439379520896941,
        0.002436148171609534,
        0.00242714737450954,
        0.0024104961008619167,
        0.0023980801514454867,
        0.0023793794828820543,
        0.0023711582247834154,
        0.0023687081295313663,
        0.002367393634997409,
        0.002363872575203228,
        0.0023529989694100633,
        0.0023505436504320716,
        0.0023500182829736998,
        0.0023411371684101882,
        0.002320561564131635,
        0.002307519007130046,
        0.0023042589100505375,
        0.002301696268955928,
        0.0022784651279107782,
        0.002265686839473261,
        0.0022656263167539123,
        0.0022603009807541066,
        0.002244060015950525,
        0.002242265053813759,
        0.002226609260071635,
        0.002221579814591676,
        0.002219100242065918,
        0.002214245360170176,
        0.0022003907248026346,
        0.0021977277095154573,
        0.002191238568326465,
        0.002189656454843889,
        0.0021893214920580234,
        0.0021867749015390178,
        0.002186310785965891,
        0.002175157834924101,
        0.0021720742403321786,
        0.002165735109592101,
        0.002161634677994335,
        0.002158385043864587,
        0.0021555952891626727,
        0.0021514208982298185,
        0.0021391173014414177,
        0.0021327685082283177,
        0.002125484567227648,
        0.002119219436727963,
        0.0021188601777971925,
        0.0021184918853549024,
        0.0021161419063122143,
        0.002112943460211472,
        0.0020980525564502027,
        0.0020927361211497846,
        0.002085865953313397,
        0.0020779598218674963,
        0.0020676913630245618,
        0.0020596587591355776,
        0.0020449075918075204,
        0.002024993868838988,
        0.002000147795651073,
        0.0019965641360150236,
        0.0019794710442732626,
        0.0019770811612632487,
        0.001971591233656189,
        0.0019710113137917946,
        0.001859494055799422,
        0.0018557635075189694,
        0.0018449137877523275,
        0.001813716689702917,
        0.0017842962367961232,
        0.0017488142290643489,
        0.0016679163398483172,
        0.0015977350501179255,
        0.0015905440756542166,
    ]
    all_name = [
        "beta_mcc",
        "theta_mcc",
        "alpha_mcc",
        "beta_ddi_12",
        "beta_ddi_13",
        "beta_ddi_11",
        "beta_ddi_2",
        "alpha_entropy_9",
        "alpha_ddi_12",
        "alpha_awe_pli_9",
        "alpha_ddi_0",
        "beta_ddi_0",
        "alpha_entropy_8",
        "beta_awd_12",
        "alpha_entropy_14",
        "beta_ddi_10",
        "beta_awd_11",
        "alpha_awe_pli_18",
        "alpha_awe_pli_6",
        "alpha_awe_pli_8",
        "beta_ddi_1",
        "beta_ddi_14",
        "theta_ddi_8",
        "alpha_ddi_14",
        "theta_ddi_9",
        "alpha_awe_pli_14",
        "alpha_ddi_13",
        "alpha_ddi_6",
        "alpha_entropy_15",
        "beta_ddi_9",
        "alpha_awd_0",
        "beta_awd_2",
        "alpha_ddi_1",
        "beta_ddi_3",
        "alpha_ddi_15",
        "alpha_awe_pli_15",
        "theta_ddi_17",
        "alpha_entropy_7",
        "alpha_ddi_10",
        "alpha_awe_pli_11",
        "alpha_entropy_6",
        "alpha_awe_pli_12",
        "beta_awd_13",
        "alpha_ddi_2",
        "beta_awd_14",
        "alpha_ddi_18",
        "alpha_ddi_9",
        "theta_ddi_14",
        "theta_mpc",
        "theta_awd_11",
        "beta_awd_10",
        "beta_entropy_16",
        "beta_awd_6",
        "beta_entropy_12",
        "alpha_ddi_16",
        "beta_ddi_17",
        "alpha_awd_12",
        "beta_awd_0",
        "beta_ddi_8",
        "alpha_awd_16",
        "theta_awd_14",
        "alpha_ddi_8",
        "beta_awd_9",
        "alpha_ddi_11",
        "alpha_ddi_7",
        "theta_awd_15",
        "alpha_ddi_17",
        "alpha_entropy_1",
        "alpha_awd_15",
        "alpha_entropy_18",
        "alpha_awe_pli_3",
        "beta_awe_pli_11",
        "theta_awe_pli_17",
        "beta_awe_pli_8",
        "alpha_awd_1",
        "alpha_entropy_2",
        "alpha_awe_pli_0",
        "theta_awd_9",
        "alpha_entropy_3",
        "beta_entropy_18",
        "alpha_awe_pli_10",
        "alpha_awd_2",
        "alpha_awe_pli_7",
        "alpha_awe_pli_13",
        "beta_entropy_17",
        "beta_awd_1",
        "theta_awe_pli_14",
        "beta_entropy_15",
        "beta_ddi_16",
        "theta_awd_8",
        "alpha_awd_11",
        "delta_awe_pli_17",
        "delta_awe_pli_18",
        "delta_awe_pli_15",
        "alpha_awd_3",
        "beta_entropy_3",
        "alpha_mpc",
        "beta_ddi_6",
        "alpha_entropy_10",
        "alpha_entropy_11",
        "alpha_ddi_3",
        "alpha_awe_pli_4",
        "beta_entropy_0",
        "beta_awe_pli_6",
        "alpha_awd_9",
        "alpha_entropy_5",
        "beta_awe_pli_5",
        "beta_awd_17",
        "beta_awd_4",
        "theta_awd_4",
        "alpha_ddi_4",
        "theta_entropy_10",
        "alpha_awe_pli_2",
        "theta_ddi_15",
        "beta_ddi_4",
        "beta_awe_pli_3",
        "alpha_awd_8",
        "alpha_awe_pli_16",
        "alpha_ddi_5",
        "delta_awe_pli_11",
        "alpha_awd_14",
        "theta_entropy_4",
        "beta_awe_pli_2",
        "delta_awe_pli_7",
        "beta_awd_5",
        "theta_entropy_0",
        "beta_ddi_15",
        "theta_ddi_12",
        "beta_mpc",
        "beta_awe_pli_17",
        "alpha_entropy_13",
        "delta_awe_pli_13",
        "theta_entropy_11",
        "beta_ddi_18",
        "beta_awe_pli_18",
        "alpha_entropy_0",
        "beta_entropy_9",
        "alpha_awe_pli_5",
        "delta_entropy_16",
        "delta_awe_pli_10",
        "alpha_awd_10",
        "delta_awe_pli_8",
        "beta_awd_8",
        "theta_awe_pli_5",
        "beta_awe_pli_14",
        "theta_ddi_1",
        "theta_entropy_9",
        "theta_awe_pli_13",
        "delta_mcc",
        "theta_entropy_17",
        "delta_awe_pli_2",
        "beta_awd_3",
        "alpha_awd_6",
        "theta_ddi_5",
        "theta_awe_pli_11",
        "alpha_awe_pli_1",
        "beta_ddi_7",
        "alpha_awd_17",
        "alpha_entropy_4",
        "theta_awd_18",
        "theta_entropy_2",
        "beta_awe_pli_7",
        "theta_awd_13",
        "theta_entropy_15",
        "beta_awe_pli_12",
        "theta_awe_pli_18",
        "theta_awd_17",
        "delta_awe_pli_16",
        "beta_awe_pli_1",
        "beta_entropy_1",
        "theta_awe_pli_10",
        "delta_awe_pli_3",
        "theta_entropy_13",
        "delta_awe_pli_5",
        "theta_entropy_6",
        "alpha_awd_4",
        "alpha_entropy_17",
        "beta_ddi_5",
        "delta_awe_pli_0",
        "delta_ddi_15",
        "theta_awe_pli_6",
        "beta_awe_pli_4",
        "theta_entropy_12",
        "beta_awe_pli_16",
        "delta_ddi_17",
        "theta_awe_pli_7",
        "beta_awe_pli_10",
        "delta_awe_pli_4",
        "beta_awe_pli_13",
        "theta_awe_pli_8",
        "delta_mpc",
        "alpha_entropy_16",
        "theta_ddi_10",
        "delta_ddi_12",
        "theta_entropy_16",
        "theta_awe_pli_0",
        "beta_awd_18",
        "theta_ddi_4",
        "beta_awd_15",
        "theta_entropy_7",
        "theta_ddi_3",
        "theta_entropy_3",
        "alpha_awe_pli_17",
        "beta_entropy_7",
        "delta_awe_pli_9",
        "beta_entropy_5",
        "beta_entropy_8",
        "theta_ddi_0",
        "delta_awe_pli_1",
        "theta_awd_12",
        "beta_entropy_14",
        "delta_awe_pli_6",
        "alpha_awd_18",
        "beta_entropy_13",
        "theta_awd_3",
        "theta_ddi_6",
        "theta_entropy_14",
        "delta_ddi_5",
        "theta_awe_pli_2",
        "beta_awe_pli_0",
        "delta_awd_10",
        "theta_entropy_1",
        "alpha_awd_13",
        "theta_ddi_16",
        "beta_awd_7",
        "theta_entropy_5",
        "theta_awd_16",
        "theta_ddi_2",
        "theta_awe_pli_9",
        "theta_ddi_13",
        "delta_awd_0",
        "delta_ddi_1",
        "delta_ddi_2",
        "delta_awd_8",
        "beta_entropy_11",
        "delta_awe_pli_12",
        "beta_awd_16",
        "beta_entropy_4",
        "beta_awe_pli_9",
        "delta_ddi_9",
        "theta_awd_1",
        "delta_entropy_15",
        "theta_awd_0",
        "delta_entropy_11",
        "alpha_awd_5",
        "theta_entropy_8",
        "theta_entropy_18",
        "alpha_entropy_12",
        "beta_entropy_6",
        "theta_awe_pli_4",
        "theta_awd_6",
        "theta_awd_10",
        "delta_entropy_4",
        "delta_ddi_8",
        "delta_entropy_12",
        "theta_awe_pli_15",
        "theta_awe_pli_1",
        "delta_entropy_3",
        "theta_awd_2",
        "theta_awd_5",
        "delta_awe_pli_14",
        "delta_entropy_0",
        "delta_entropy_10",
        "beta_entropy_2",
        "theta_ddi_7",
        "alpha_awd_7",
        "theta_ddi_18",
        "theta_awe_pli_3",
        "theta_awe_pli_16",
        "delta_awd_14",
        "theta_awd_7",
        "delta_entropy_13",
        "delta_ddi_0",
        "delta_ddi_13",
        "beta_entropy_10",
        "delta_ddi_18",
        "delta_awd_11",
        "delta_ddi_14",
        "delta_ddi_4",
        "theta_awe_pli_12",
        "delta_awd_3",
        "delta_awd_5",
        "delta_ddi_6",
        "delta_awd_2",
        "delta_ddi_11",
        "delta_awd_1",
        "delta_entropy_8",
        "delta_ddi_3",
        "delta_entropy_18",
        "delta_entropy_7",
        "delta_awd_15",
        "delta_awd_12",
        "delta_ddi_7",
        "delta_awd_4",
        "delta_awd_18",
        "beta_awe_pli_15",
        "delta_entropy_5",
        "delta_ddi_10",
        "delta_awd_6",
        "delta_awd_9",
        "delta_entropy_14",
        "delta_awd_16",
        "delta_entropy_2",
        "delta_awd_17",
        "delta_ddi_16",
        "delta_entropy_1",
        "theta_ddi_11",
        "delta_entropy_9",
        "delta_entropy_17",
        "delta_entropy_6",
        "delta_awd_7",
        "delta_awd_13",
    ]
    all_name_drop_fre = [
        "mcc",
        "mcc",
        "mcc",
        "ddi_12",
        "ddi_13",
        "ddi_11",
        "ddi_2",
        "entropy_9",
        "ddi_12",
        "awe_pli_9",
        "ddi_0",
        "ddi_0",
        "entropy_8",
        "awd_12",
        "entropy_14",
        "ddi_10",
        "awd_11",
        "awe_pli_18",
        "awe_pli_6",
        "awe_pli_8",
        "ddi_1",
        "ddi_14",
        "ddi_8",
        "ddi_14",
        "ddi_9",
        "awe_pli_14",
        "ddi_13",
        "ddi_6",
        "entropy_15",
        "ddi_9",
        "awd_0",
        "awd_2",
        "ddi_1",
        "ddi_3",
        "ddi_15",
        "awe_pli_15",
        "ddi_17",
        "entropy_7",
        "ddi_10",
        "awe_pli_11",
        "entropy_6",
        "awe_pli_12",
        "awd_13",
        "ddi_2",
        "awd_14",
        "ddi_18",
        "ddi_9",
        "ddi_14",
        "mpc",
        "awd_11",
        "awd_10",
        "entropy_16",
        "awd_6",
        "entropy_12",
        "ddi_16",
        "ddi_17",
        "awd_12",
        "awd_0",
        "ddi_8",
        "awd_16",
        "awd_14",
        "ddi_8",
        "awd_9",
        "ddi_11",
        "ddi_7",
        "awd_15",
        "ddi_17",
        "entropy_1",
        "awd_15",
        "entropy_18",
        "awe_pli_3",
        "awe_pli_11",
        "awe_pli_17",
        "awe_pli_8",
        "awd_1",
        "entropy_2",
        "awe_pli_0",
        "awd_9",
        "entropy_3",
        "entropy_18",
        "awe_pli_10",
        "awd_2",
        "awe_pli_7",
        "awe_pli_13",
        "entropy_17",
        "awd_1",
        "awe_pli_14",
        "entropy_15",
        "ddi_16",
        "awd_8",
        "awd_11",
        "awe_pli_17",
        "awe_pli_18",
        "awe_pli_15",
        "awd_3",
        "entropy_3",
        "mpc",
        "ddi_6",
        "entropy_10",
        "entropy_11",
        "ddi_3",
        "awe_pli_4",
        "entropy_0",
        "awe_pli_6",
        "awd_9",
        "entropy_5",
        "awe_pli_5",
        "awd_17",
        "awd_4",
        "awd_4",
        "ddi_4",
        "entropy_10",
        "awe_pli_2",
        "ddi_15",
        "ddi_4",
        "awe_pli_3",
        "awd_8",
        "awe_pli_16",
        "ddi_5",
        "awe_pli_11",
        "awd_14",
        "entropy_4",
        "awe_pli_2",
        "awe_pli_7",
        "awd_5",
        "entropy_0",
        "ddi_15",
        "ddi_12",
        "mpc",
        "awe_pli_17",
        "entropy_13",
        "awe_pli_13",
        "entropy_11",
        "ddi_18",
        "awe_pli_18",
        "entropy_0",
        "entropy_9",
        "awe_pli_5",
        "entropy_16",
        "awe_pli_10",
        "awd_10",
        "awe_pli_8",
        "awd_8",
        "awe_pli_5",
        "awe_pli_14",
        "ddi_1",
        "entropy_9",
        "awe_pli_13",
        "mcc",
        "entropy_17",
        "awe_pli_2",
        "awd_3",
        "awd_6",
        "ddi_5",
        "awe_pli_11",
        "awe_pli_1",
        "ddi_7",
        "awd_17",
        "entropy_4",
        "awd_18",
        "entropy_2",
        "awe_pli_7",
        "awd_13",
        "entropy_15",
        "awe_pli_12",
        "awe_pli_18",
        "awd_17",
        "awe_pli_16",
        "awe_pli_1",
        "entropy_1",
        "awe_pli_10",
        "awe_pli_3",
        "entropy_13",
        "awe_pli_5",
        "entropy_6",
        "awd_4",
        "entropy_17",
        "ddi_5",
        "awe_pli_0",
        "ddi_15",
        "awe_pli_6",
        "awe_pli_4",
        "entropy_12",
        "awe_pli_16",
        "ddi_17",
        "awe_pli_7",
        "awe_pli_10",
        "awe_pli_4",
        "awe_pli_13",
        "awe_pli_8",
        "mpc",
        "entropy_16",
        "ddi_10",
        "ddi_12",
        "entropy_16",
        "awe_pli_0",
        "awd_18",
        "ddi_4",
        "awd_15",
        "entropy_7",
        "ddi_3",
        "entropy_3",
        "awe_pli_17",
        "entropy_7",
        "awe_pli_9",
        "entropy_5",
        "entropy_8",
        "ddi_0",
        "awe_pli_1",
        "awd_12",
        "entropy_14",
        "awe_pli_6",
        "awd_18",
        "entropy_13",
        "awd_3",
        "ddi_6",
        "entropy_14",
        "ddi_5",
        "awe_pli_2",
        "awe_pli_0",
        "awd_10",
        "entropy_1",
        "awd_13",
        "ddi_16",
        "awd_7",
        "entropy_5",
        "awd_16",
        "ddi_2",
        "awe_pli_9",
        "ddi_13",
        "awd_0",
        "ddi_1",
        "ddi_2",
        "awd_8",
        "entropy_11",
        "awe_pli_12",
        "awd_16",
        "entropy_4",
        "awe_pli_9",
        "ddi_9",
        "awd_1",
        "entropy_15",
        "awd_0",
        "entropy_11",
        "awd_5",
        "entropy_8",
        "entropy_18",
        "entropy_12",
        "entropy_6",
        "awe_pli_4",
        "awd_6",
        "awd_10",
        "entropy_4",
        "ddi_8",
        "entropy_12",
        "awe_pli_15",
        "awe_pli_1",
        "entropy_3",
        "awd_2",
        "awd_5",
        "awe_pli_14",
        "entropy_0",
        "entropy_10",
        "entropy_2",
        "ddi_7",
        "awd_7",
        "ddi_18",
        "awe_pli_3",
        "awe_pli_16",
        "awd_14",
        "awd_7",
        "entropy_13",
        "ddi_0",
        "ddi_13",
        "entropy_10",
        "ddi_18",
        "awd_11",
        "ddi_14",
        "ddi_4",
        "awe_pli_12",
        "awd_3",
        "awd_5",
        "ddi_6",
        "awd_2",
        "ddi_11",
        "awd_1",
        "entropy_8",
        "ddi_3",
        "entropy_18",
        "entropy_7",
        "awd_15",
        "awd_12",
        "ddi_7",
        "awd_4",
        "awd_18",
        "awe_pli_15",
        "entropy_5",
        "ddi_10",
        "awd_6",
        "awd_9",
        "entropy_14",
        "awd_16",
        "entropy_2",
        "awd_17",
        "ddi_16",
        "entropy_1",
        "ddi_11",
        "entropy_9",
        "entropy_17",
        "entropy_6",
        "awd_7",
        "awd_13",
    ]
    all_pdf = pd.DataFrame([])
    all_pdf["name"] = all_name
    all_pdf["importance"] = all_importance
    all_pdf["category"] = [_[:3] for _ in all_name_drop_fre]
    all_pdf["frequency"] = [_[:3] for _ in all_name]

    g = sns.catplot(
        data=all_pdf,
        x="name",
        y="importance",
        hue="frequency",
        hue_order=[
            "del",
            "the",
            "alp",
            "bet",
        ],
        # ["mcc", "mpc", "ddi", "ent", "awd", "awe"],
        kind="bar",
        # log_scale=True,
        palette=sns.color_palette("bright"),
        height=5,
        aspect=2,
    )
    # g.refline(y=-np.log10(0.05))
    ax = g.ax
    ax.set_xlabel("feature")
    ax.set_ylabel("importance")
    ax.set_xticklabels("")
    plt.savefig("feature_importance_frequency.svg", dpi=660)

    # g = sns.catplot(
    #     data=all_pdf,
    #     x="name",
    #     y="-pval_log10",
    #     hue="category",
    #     hue_order=["mcc", "mpc", "ddi", "ent", "awd", "awe"],
    #     kind="bar",
    #     # log_scale=True,
    #     palette=sns.color_palette("muted"),
    #     height=5,
    #     aspect=2,
    # )
    # g.refline(y=-np.log10(0.05))
    # ax = g.ax
    # ax.set_xlabel("beta")
    # ax.set_ylabel(r"$-\log{p\_val}$")
    # ax.set_xticklabels("")
    # plt.savefig("beta_anova.svg", dpi=660)
    # plt.show()


if __name__ == "__main__":
    # plot_eeg_wave()
    # plot_eeg_spectrum()
    # plot_feature_dist()
    # re num (\d.\d+[e]?[-]?\d+)
    # re name (\w+)
    plot_anova()
